(()=>{var modal=jQuery('#modalSearch');modal.on('show.bs.modal',function(){!function localSearchFunc(path,searchSelector,resultSelector){var $input=jQuery(searchSelector),$result=jQuery(resultSelector);if(0===$input.length)throw Error('No element selected by the searchSelector');if(0===$result.length)throw Error('No element selected by the resultSelector');-1===$result.attr('class').indexOf('list-group-item')&&$result.html('<div class="m-auto text-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div><br/>Loading...</div>'),jQuery.ajax({url:path,dataType:'xml',success:function(xmlResponse){var dataList=jQuery('entry',xmlResponse).map(function(){return{title:jQuery('title',this).text(),content:jQuery('content',this).text(),url:jQuery('url',this).text()}}).get();-1===$result.html().indexOf('list-group-item')&&$result.html(''),$input.on('input',function(){var content=$input.val(),resultHTML='',keywords=content.trim().toLowerCase().split(/[\s-]+/);return $result.html(''),content.trim().length<=0?$input.removeClass('invalid').removeClass('valid'):(dataList.forEach(function(data){var index_title,match_content,isMatch=!0,orig_data_title=(data.title&&''!==data.title.trim()||(data.title='Untitled'),data.title.trim()),data_title=orig_data_title.toLowerCase(),orig_data_content=data.content.trim().replace(/<[^>]+>/g,''),data_content=orig_data_content.toLowerCase(),data=data.url,index_content=-1,first_occur=-1;CONFIG.include_content_in_search&&''===data_content?isMatch=!1:keywords.forEach(function(keyword,i){index_title=data_title.indexOf(keyword),index_content=data_content.indexOf(keyword),index_title<0&&index_content<0?isMatch=!1:(index_content<0&&(index_content=0),0===i&&(first_occur=index_content))}),isMatch&&(resultHTML+='<a href=\''+data+'\' class=\'list-group-item list-group-item-action font-weight-bolder search-list-title\'>'+orig_data_title+'</a>',data=orig_data_content,0<=first_occur)&&(orig_data_title=first_occur+80,(orig_data_title=0===(orig_data_content=(orig_data_content=first_occur-20)<0?0:orig_data_content)?100:orig_data_title)>data.length&&(orig_data_title=data.length),match_content=data.substring(orig_data_content,orig_data_title),keywords.forEach(function(keyword){var regS=new RegExp(keyword,'gi');match_content=match_content.replace(regS,'<span class="search-word">'+keyword+'</span>')}),resultHTML+='<p class=\'search-list-content\'>'+match_content+'...</p>')}),-1===resultHTML.indexOf('list-group-item')?$input.addClass('invalid').removeClass('valid'):($input.addClass('valid').removeClass('invalid'),void $result.html(resultHTML)))})}})}(CONFIG.search_path||'/local-search.xml','#local-search-input','#local-search-result')}),modal.on('shown.bs.modal',function(){jQuery('#local-search-input').focus()}),modal.on('hidden.bs.modal',function(){!function localSearchReset(searchSelector,resultSelector){if(searchSelector=jQuery(searchSelector),resultSelector=jQuery(resultSelector),0===searchSelector.length)throw Error('No element selected by the searchSelector');if(0===resultSelector.length)throw Error('No element selected by the resultSelector');searchSelector.val('').removeClass('invalid').removeClass('valid'),resultSelector.html('')}('#local-search-input','#local-search-result')})})();